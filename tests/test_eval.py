from lib.eval import annotation, recall_iou

def test_annotation():

    assert annotation('2000010000005', annotation_dir='/data/training_1388/data/Annotations/') == [
	[1327.2880382976, 290.5416267776, 1338.5569379327999, 299.850717696, 15], 
	[1354.2354066432, 287.1119617024, 1365.5043062783998, 296.9110047744, 15], 
	[1244.4861244416002, 293.4813396992, 1257.2248805376003, 297.8909090816, 7], 
	[1088.6813395968, 331.69760768, 1113.6688994304, 338.5569378304, 7], 
	[1576.1837319168, 271.4334928384, 1590.8822965248, 275.3531100672, 7], 
	[2294.4535885824, 309.649760768, 2303.2727273471996, 314.54928230400003, 7]]


def test_recall_iou():
    gt = [(1,1,3,3,  7), (1,5,2,6,  7), (5,1,7,3,  7)]
    det = {'face': [[2,1,3,4], [5,1,7,3]]}

    assert recall_iou(det, gt) == (0.6666666666666666, [0.5, 1.0])
